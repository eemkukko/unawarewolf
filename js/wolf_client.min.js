var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,r=!1,s=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,s=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw s}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var socket=io(),card_names=["BACK","BACK_SELECTED","DOPPELGANGER","DRUNK","HUNTER","INSOMNIAC","MASON","MINION","ROBBER","SEER","TROUBLEMAKER","VILLAGER","WEREWOLF","NOTHING"],img_sources={},_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=card_names[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var c_name=_step.value;img_sources[c_name]="/static/card_"+c_name.toLowerCase()+".png"}}catch(e){_didIteratorError=!0,_iteratorError=e}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}function sendLoginMessage(){socket.emit("loginMessage",document.getElementById("nameInputField").value.toString())}function sendRequestStatus(){socket.emit("debug_getStatus"),console.log("Status update requested")}function sendClientGameUpdate(e){socket.emit("clientGameUpdate",e),console.log("Msg sent with data:"),console.log(e)}function sendFinishGame(){socket.emit("debug_finishGame"),console.log("Sent finish game message")}function sendReadyMessage(){socket.emit("togglePlayerReady")}function sendSetSettingsMessage(e){socket.emit("setGameSettings",e),console.log("Sent game settings:"),console.log(e)}function sendGetSettingsMessage(){socket.emit("getGameSettings")}function sendGetPlayerListMessage(){socket.emit("getPlayerList")}function sendVote(e){socket.emit("clientGameVote",{vote:e})}function isVowel(e){return"AaEeIiOoUuYy".includes(e)}var CardButton=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.handleClick=a.handleClick.bind(a),a.state={selected:!1,value:a.props.value,keep_facedown:a.props.keepDown},a}return _inherits(t,React.Component),_createClass(t,[{key:"handleClick",value:function(){this.props.autoFlip||(this.props.onClick(this.state.value,this.state.selected),this.setState({selected:!this.state.selected}))}},{key:"componentDidMount",value:function(){var e=this;this.props.autoFlip&&setTimeout((function(){e.setState({selected:!0})}),800)}},{key:"render",value:function(){if(this.state.keep_facedown){var e=this.state.selected?img_sources.BACK_SELECTED:img_sources.BACK;return React.createElement("div",{className:"cardContainer"},React.createElement("input",{id:"card"+this.state.value.toString(),className:"cardImage",type:"image",src:e,onClick:this.handleClick}),React.createElement("label",{htmlFor:this.state.value.toString()},this.props.label))}var t="card_"+this.state.value.toString();return React.createElement("div",{className:this.state.selected?"cardContainer active":"cardContainer"},React.createElement("div",{id:t,className:"cardInner",transform:this.state.selected?"rotateY(180deg)":null},React.createElement("div",{className:"cardBack"},React.createElement("input",{type:"image",className:"cardImage",src:img_sources.BACK,onClick:this.handleClick})),React.createElement("div",{className:"cardFace"},React.createElement("input",{type:"image",className:"cardImage",src:img_sources[this.props.face]}))),React.createElement("label",{htmlFor:t},this.props.label))}}]),t}();function DisplayPlayerCards(e){var t=e.playerList.filter((function(t){return t!=e.myName})),a=[],n=[],r=0,s=!0,o=!1,i=void 0;try{for(var l,c=t[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var u=l.value;n.push(u),r>0&&((r+1)%3==0||r+1===t.length)&&(a.push(React.createElement(CardRow,{key:"row_"+n.join(),values:n,onClick:function(t){return e.onClick(t)},centerCards:!1})),n=[]),r++}}catch(e){o=!0,i=e}finally{try{!s&&c.return&&c.return()}finally{if(o)throw i}}return React.createElement("div",{className:"cardDisplay"},a)}function DisplayCenterCards(e){if(0===e.centerCount)return React.createElement("div",{className:"cardDisplay"},"(Sorry, but there are no center cards...)");for(var t=[],a=[],n=0;n<e.centerCount;n++)a.push(n),(n+1)%3!=0&&n+1!==e.centerCount||(t.push(React.createElement(CardRow,{key:"row_"+a.join(),values:a,onClick:function(t){return e.onClick(t)},centerCards:!0})),a=[]);return React.createElement("div",{className:"cardDisplay"},t)}function CardRow(e){return React.createElement("div",{className:"cardRow"},e.values.map((function(t){return e.centerCards?React.createElement(CardButton,{key:"card_"+t.toString(),value:t,onClick:function(t){return e.onClick(t)},label:"Center card "+(t+1).toString(),keepDown:!0}):React.createElement(CardButton,{key:"card_"+t.toString(),value:t,onClick:function(t){return e.onClick(t)},label:t,keepDown:!0})})))}var SeerOptions=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={seer_selection:0,cardChoices:[],roleData:[],result_string:""},a}return _inherits(t,React.Component),_createClass(t,[{key:"setSeerSelection",value:function(e){this.setState({seer_selection:e})}},{key:"makeMovePayload",value:function(){var e={moveType:"SEER"};return e.cards=this.state.cardChoices,1===this.state.seer_selection?e.details={center:!1,doppel:this.props.doppel}:2===this.state.seer_selection&&(e.details={center:!0,doppel:this.props.doppel}),e}},{key:"handleAction",value:function(e){var t=this,a=this.state.cardChoices;a.includes(e)?a.splice(a.indexOf(e),1):a.push(e),console.log(a),this.setState({cardChoices:a},(function(){var e=t.state.cardChoices.length,a=t.state.seer_selection;(1===a&&e>0||2===a&&(e===t.props.centerCount||e>1))&&sendClientGameUpdate(t.makeMovePayload())}))}},{key:"componentDidMount",value:function(){var e=this;socket.on("roleInfo",(function(t){if(1===e.state.seer_selection){var a=isVowel(t[0].charAt(0))?"an":"a",n="You saw "+e.state.cardChoices[0]+"s card. It was "+a+" "+t[0];e.props.addIntel(n)}else if(2===e.state.seer_selection){var r="You looked at center card "+(e.state.cardChoices[0]+1)+" and "+(e.state.cardChoices[1]+1)+". \n                You saw "+(isVowel(t[0].charAt(0))?"an":"a")+" "+t[0];e.props.centerCount>1&&(r+=" and "+(isVowel(t[1].charAt(0))?"an":"a")+" "+t[1]),e.props.addIntel(r)}e.setState({roleData:t,seer_selection:3});var s="";setTimeout((function(){s="You see ";for(var t=0;t<e.state.roleData.length;t++){t>0&&(s+=" and ");var a=isVowel(e.state.roleData[t][0])?"an":"a";s+=a+" "+e.state.roleData[t]}e.setState({result_string:s})}),1e3)}))}},{key:"componentWillUnmount",value:function(){socket.on("roleInfo",(function(e){console.log("Component has been unmounted")}))}},{key:"render",value:function(){var e=this,t=this.state.seer_selection;switch(0===t&&0===this.props.centerCount&&(t=1,this.setState({seer_selection:1})),t){case 0:return React.createElement("div",{className:"seerSelection"},React.createElement("button",{onClick:this.setSeerSelection.bind(this,1)},"See another players card"),React.createElement("button",{onClick:this.setSeerSelection.bind(this,2)},"See 2 center cards"));case 1:return React.createElement("div",{className:"seerSelection"},React.createElement("p",null,"Select a player card to view:"),React.createElement(DisplayPlayerCards,{playerList:this.props.playerList,myName:this.props.myName,onClick:function(t){return e.handleAction(t)}}));case 2:return React.createElement("div",{className:"seerSelection"},React.createElement("p",null,"Select 2 center cards to view:"),React.createElement(DisplayCenterCards,{centerCount:this.props.centerCount,onClick:function(t){return e.handleAction(t)}}));case 3:if(this.state.roleData){for(var a=[],n=0;n<this.state.roleData.length;n++)a.push(React.createElement(CardButton,{key:"flipCard"+n.toString(),value:n,keepDown:!1,face:this.state.roleData[n],autoFlip:!0,label:""}));return React.createElement("div",{className:"seerSelection"},React.createElement("p",null,this.state.result_string),React.createElement("div",{className:"autoFlipButtons"},a))}return React.createElement("p",null,"You focus your magical powers...")}}}]),t}(),WerewolfOptions=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.makeMovePayload=a.makeMovePayload.bind(a),a.state={alone:!1,roleData:[],cardChoice:-1,turn_state:0,result_string:""},a}return _inherits(t,React.Component),_createClass(t,[{key:"componentDidMount",value:function(){var e=this;socket.on("roleInfo",(function(t){if(0===e.state.turn_state||1===e.state.turn_state)if(e.setState({alone:t.alone,roleData:t.others,turn_state:1}),t.alone)e.props.addIntel("You were the only werewolf.");else{var a=t.others.length>1?"werewolves were":"werewolf was";e.props.addIntel("The other "+a+" "+t.others.join(", "))}else if(2===e.state.turn_state){var n=isVowel(t[0].charAt(0))?"an":"a",r="You looked at center card "+(e.state.cardChoice+1)+". It was "+n+" "+t[0];e.props.addIntel(r),e.setState({roleData:t,turn_state:3}),setTimeout((function(){e.setState({result_string:"You see a "+t[0]})}),1e3)}}))}},{key:"componentWillUnmount",value:function(){socket.on("roleInfo",(function(e){console.log("Component has been unmounted")}))}},{key:"makeMovePayload",value:function(){return{moveType:"WEREWOLF",cards:[this.state.cardChoice]}}},{key:"handleAction",value:function(e){var t=this,a=parseInt(e);this.setState({cardChoice:a,turn_state:2},(function(){return sendClientGameUpdate(t.makeMovePayload())}))}},{key:"render",value:function(){var e=this;switch(this.state.turn_state){case 0:return React.createElement("div",{className:"werewolfOptions"},React.createElement("p",null,"You smell the air and look for other werewolves..."));case 1:return this.state.alone?React.createElement("div",{className:"werewolfOptions"},React.createElement("p",null,"You are the only werewolf. Select a center card to view:"),React.createElement(DisplayCenterCards,{centerCount:this.props.centerCount,onClick:function(t){return e.handleAction(t)}})):React.createElement("div",{className:"werewolfOptions"},React.createElement("p",null,"The other werewolves are: "),React.createElement("ul",null,this.state.roleData.map((function(e){return React.createElement("li",{key:e},e)}))));case 2:return React.createElement("div",{className:"werewolfOptions"},React.createElement("p",null,"You turn over the center card..."));case 3:return React.createElement("div",{className:"werewolfOptions"},React.createElement("p",null,this.state.result_string),React.createElement(CardButton,{key:"flipCard"+this.state.cardChoice.toString(),value:this.state.cardChoice,keepDown:!1,face:this.state.roleData[0],autoFlip:!0,label:""}))}}}]),t}(),TroublemakerOptions=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.makeMovePayload=a.makeMovePayload.bind(a),a.state={choices:[],moveSent:!1},a}return _inherits(t,React.Component),_createClass(t,[{key:"handleAction",value:function(e){var t=this,a=this.state.choices;a.includes(e)?a.splice(a.indexOf(e),1):a.push(e),this.setState({cardChoices:a},(function(){if(2===t.state.choices.length){sendClientGameUpdate(t.makeMovePayload());var e="You swapped the cards of "+t.state.choices[0]+" and "+t.state.choices[1]+".";t.props.addIntel(e)}}))}},{key:"makeMovePayload",value:function(){if(2==this.state.choices.length){var e={moveType:"TROUBLEMAKER",cards:this.state.choices,details:{doppel:!!this.props.doppel}};return this.setState({moveSent:!0}),e}}},{key:"render",value:function(){var e=this;return this.state.moveSent?React.createElement("div",{className:"troublemakerOptions"},React.createElement("p",null,"You swapped the cards of ",this.state.choices[0]," and ",this.state.choices[1],".")):React.createElement("div",{className:"troublemakerOptions"},React.createElement("p",null,"Select 2 cards to swap: "),React.createElement(DisplayPlayerCards,{playerList:this.props.playerList,myName:this.props.myName,onClick:function(t){return e.handleAction(t)}}))}}]),t}(),RobberOptions=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.makeMovePayload=a.makeMovePayload.bind(a),a.state={turn_state:0,choice:"",roleData:"",result_string:""},a}return _inherits(t,React.Component),_createClass(t,[{key:"componentDidMount",value:function(){var e=this;socket.on("roleInfo",(function(t){if(1===e.state.turn_state){var a=isVowel(t[0].charAt(0))?"an":"a",n="You robbed "+e.state.choice+" and became "+a+" "+t[0];e.props.addIntel(n),e.setState({roleData:t[0],turn_state:2}),setTimeout((function(){e.setState({result_string:n})}),1e3)}}))}},{key:"componentWillUnmount",value:function(){socket.on("roleInfo",(function(e){console.log("Component has been unmounted")}))}},{key:"makeMovePayload",value:function(){var e={moveType:"ROBBER",cards:[this.state.choice],details:{doppel:!!this.props.doppel}};return this.setState({turn_state:1}),e}},{key:"handleAction",value:function(e){var t=this;this.setState({choice:e},(function(){sendClientGameUpdate(t.makeMovePayload()),t.setState({turn_state:1})}))}},{key:"render",value:function(){var e=this;switch(this.state.turn_state){case 0:return React.createElement("div",{className:"robberOptions"},React.createElement("p",null,"Select a player to rob: "),React.createElement(DisplayPlayerCards,{playerList:this.props.playerList,myName:this.props.myName,onClick:function(t){return e.handleAction(t)}}));case 1:return React.createElement("div",{className:"robberOptions"},React.createElement("p",null,"You search through ",this.state.choice,"s belongings..."));case 2:return React.createElement("div",{className:"robberOptions"},React.createElement("p",null,this.state.result_string),React.createElement(CardButton,{key:"flipCard"+this.state.choice.toString(),value:this.state.choice,keepDown:!1,face:this.state.roleData,autoFlip:!0,label:""}))}}}]),t}(),MinionOptions=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={roleData:[],alone:!1,waitingForServer:!0},a}return _inherits(t,React.Component),_createClass(t,[{key:"componentDidMount",value:function(){var e=this;socket.on("roleInfo",(function(t){if(e.state.waitingForServer)if(e.setState({alone:t.alone,roleData:t.others,waitingForServer:!1}),t.alone)e.props.addIntel("You didn't see any werewolves.");else{var a=t.others.length>1?"were werewolves":"was a werewolf";e.props.addIntel(t.others.join(", ")+" "+a+".")}}))}},{key:"componentWillUnmount",value:function(){socket.on("roleInfo",(function(e){console.log("Component has been unmounted")}))}},{key:"render",value:function(){return this.state.waitingForServer?React.createElement("div",{className:"minionOptions"},React.createElement("p",null,"You wait for a signal from your werewolf allies...")):this.state.alone?React.createElement("div",{className:"minionOptions"},React.createElement("p",null,"There are no werewolves in the village. Stay alive and make sure someone else dies!")):React.createElement("div",{className:"minionOptions"},React.createElement("p",null,"The werewolves are:"),React.createElement("ul",null,this.state.roleData.map((function(e){return React.createElement("li",{key:e},e)}))),React.createElement("p",null,"Take the heat off the werewolves, even if it means sacrificing yourself!"))}}]),t}(),MasonOptions=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={roleData:[],alone:!1,waitingForServer:!0},a}return _inherits(t,React.Component),_createClass(t,[{key:"componentDidMount",value:function(){var e=this;socket.on("roleInfo",(function(t){if(e.state.waitingForServer)if(e.setState({alone:t.alone,roleData:t.others,waitingForServer:!1}),t.alone)e.props.addIntel("You didn't see any other masons.");else{var a=t.others.length>1?"masons were":"mason was";e.props.addIntel("The other "+a+" "+t.others.join(", "))}}))}},{key:"componentWillUnmount",value:function(){socket.on("roleInfo",(function(e){console.log("Component has been unmounted")}))}},{key:"render",value:function(){return this.state.waitingForServer?React.createElement("div",{className:"masonOptions"},React.createElement("p",null,"You make your way to the secret meeting place...")):this.state.alone?React.createElement("div",{className:"masonOptions"},React.createElement("p",null,"You are the only mason.")):React.createElement("div",{className:"masonOptions"},React.createElement("p",null,"The other masons are:"),React.createElement("ul",null,this.state.roleData.map((function(e){return React.createElement("li",{key:e},e)}))))}}]),t}(),DrunkOptions=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={done:!1,choice:-1},a}return _inherits(t,React.Component),_createClass(t,[{key:"makeMovePayload",value:function(){return{moveType:"DRUNK",cards:[this.state.choice],details:{doppel:!!this.props.doppel}}}},{key:"handleAction",value:function(e){var t=this;this.setState({choice:parseInt(e),done:!0},(function(){sendClientGameUpdate(t.makeMovePayload());var e="You swapped your card with center card "+(t.state.choice+1)+".";t.props.addIntel(e)}))}},{key:"render",value:function(){var e=this;return this.state.done?React.createElement("div",null,React.createElement("p",null,"You swapped your card with center card ",this.state.choice+1,", but can't seem to remember what you got in return...")):React.createElement("div",{className:"drunkOptions"},React.createElement("p",null,"Select a center card:"),React.createElement(DisplayCenterCards,{centerCount:this.props.centerCount,onClick:function(t){return e.handleAction(t)}}))}}]),t}(),InsomniacOptions=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={waitingForServer:!0,done:!1,roleData:"NOTHING"},a}return _inherits(t,React.Component),_createClass(t,[{key:"componentDidMount",value:function(){var e=this;socket.on("roleInfo",(function(t){if(e.state.waitingForServer){e.setState({roleData:t[0],waitingForServer:!1});var a=isVowel(t[0].charAt(0))?"an":"a";e.props.addIntel("In the end, your card was "+a+" "+t[0])}}))}},{key:"componentWillUnmount",value:function(){socket.on("roleInfo",(function(e){console.log("Component has been unmounted")}))}},{key:"render",value:function(){var e=this,t=this.state.done?React.createElement("p",null,"You look at your card and see: ",this.state.roleData):React.createElement("p",null,"Look at your own card.");return React.createElement("div",{className:"insomniacOptions"},t,React.createElement(CardButton,{label:"Your card",value:0,onClick:function(){return e.setState({done:!0})},keepDown:!1,face:this.state.roleData}))}}]),t}(),DoppelgangerOptions=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.makeMovePayload=a.makeMovePayload.bind(a),a.state={turn_state:0,choice:"",roleData:"",result_string:""},a}return _inherits(t,React.Component),_createClass(t,[{key:"componentDidMount",value:function(){var e=this;socket.on("roleInfo",(function(t){if(1===e.state.turn_state){e.setState({roleData:t[0],turn_state:2}),e.props.updateAlt(t[0]);var a=isVowel(t[0].charAt(0))?"an":"a",n="You copied "+e.state.choice+"s card and transformed into a "+a+" "+t[0];e.props.addIntel(n),setTimeout((function(){e.setState({result_string:n})}),1e3),["SEER","ROBBER","TROUBLEMAKER","DRUNK"].includes(t[0])&&setTimeout((function(){e.setState({turn_state:3})}),2e3)}}))}},{key:"componentWillUnmount",value:function(){socket.on("roleInfo",(function(e){console.log("Component has been unmounted")}))}},{key:"makeMovePayload",value:function(){var e={moveType:"DOPPELGANGER",cards:[this.state.choice]};return this.setState({turn_state:1}),e}},{key:"handleAction",value:function(e){var t=this;this.setState({choice:e},(function(){sendClientGameUpdate(t.makeMovePayload()),t.setState({turn_state:1})}))}},{key:"render",value:function(){var e=this;switch(this.state.turn_state){case 0:return React.createElement("div",{className:"doppelOptions"},React.createElement("p",null,"Select a player to doppel: "),React.createElement(DisplayPlayerCards,{playerList:this.props.playerList,myName:this.props.myName,onClick:function(t){return e.handleAction(t)}}));case 1:return React.createElement("div",{className:"doppelOptions"},React.createElement("p",null,"You spy on ",this.state.choice,"s every move..."));case 2:return"DOPPELGANGER"===this.state.roleData?React.createElement("div",{className:"doppelOptions"},React.createElement("p",null,"You transformed into ",this.state.choice,"s role, but they were also a doppelganger. You are still on the villager team."),React.createElement(CardButton,{key:"flipCard"+this.state.choice.toString(),value:this.state.choice,keepDown:!1,face:this.state.roleData,autoFlip:!0,label:""})):React.createElement("div",{className:"doppelOptions"},React.createElement("p",null,this.state.result_string),React.createElement(CardButton,{key:"flipCard"+this.state.choice.toString(),value:this.state.choice,keepDown:!1,face:this.state.roleData,autoFlip:!0,label:""}));case 3:var t=isVowel(this.state.roleData.charAt(0))?"an":"a";return React.createElement("div",{className:"doppelOptions"},React.createElement("p",null,"You have transformed into ",t," ",this.state.roleData,"."),this.props.createRoleOptions(this.state.roleData));default:return React.createElement("div",{className:"doppelOptions"})}}}]),t}(),PlayArea=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={altRole:"NOTHING",readyToSleep:!1},a}return _inherits(t,React.Component),_createClass(t,[{key:"updateAlt",value:function(e){this.setState({altRole:e})}},{key:"handleBedtimeClick",value:function(){this.state.readyToSleep||this.setState({readyToSleep:!0},sendReadyMessage)}},{key:"createRoleOptions",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(e){case"WEREWOLF":return React.createElement(WerewolfOptions,{centerCount:this.props.centerCount,playerList:this.props.playerList,addIntel:this.props.addIntel});case"SEER":return React.createElement(SeerOptions,{centerCount:this.props.centerCount,playerList:this.props.playerList,myName:this.props.myName,doppel:a,addIntel:this.props.addIntel});case"TROUBLEMAKER":return React.createElement(TroublemakerOptions,{playerList:this.props.playerList,myName:this.props.myName,doppel:a,addIntel:this.props.addIntel});case"MINION":return React.createElement(MinionOptions,{addIntel:this.props.addIntel});case"MASON":return React.createElement(MasonOptions,{addIntel:this.props.addIntel});case"DRUNK":return React.createElement(DrunkOptions,{centerCount:this.props.centerCount,doppel:a,addIntel:this.props.addIntel});case"INSOMNIAC":return React.createElement(InsomniacOptions,{addIntel:this.props.addIntel});case"ROBBER":return React.createElement(RobberOptions,{playerList:this.props.playerList,myName:this.props.myName,doppel:a,addIntel:this.props.addIntel});case"DOPPELGANGER":return React.createElement(DoppelgangerOptions,{playerList:this.props.playerList,myName:this.props.myName,centerCount:this.props.centerCount,createRoleOptions:function(e,a){return t.createRoleOptions(e,!0)},updateAlt:function(e){return t.updateAlt(e)},addIntel:this.props.addIntel});case"NOTHING":return React.createElement("div",null,"Game is in a weird limbo state, stand by...");default:return React.createElement("div",null,"This client is outdated. Try refreshing the page and starting a new game")}}},{key:"render",value:function(){var e=this;return this.props.bedTimePhase?React.createElement("div",{className:"playArea roleActive"},React.createElement("div",{className:"bedTimeCard"},React.createElement("p",null,"This is your card. Tap on it to see what it is"),React.createElement(CardButton,{label:"",value:0,onClick:function(){return e.handleBedtimeClick()},keepDown:!1,face:this.props.role}))):"DOPPELGANGER"===this.props.turn||"DOPPELGANGER"!==this.props.role||["NOTHING","DOPPELGANGER","SEER","ROBBER","TROUBLEMAKER","DRUNK"].includes(this.state.altRole)||this.props.turn!==this.state.altRole?this.props.turn===this.props.role?React.createElement("div",{className:"playArea roleActive"},this.createRoleOptions(this.props.role)):React.createElement("div",{className:"playArea"}):React.createElement("div",{className:"playArea roleActive"},this.createRoleOptions(this.state.altRole))}}]),t}(),VoteButton=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.handleClick=a.handleClick.bind(a),a}return _inherits(t,React.Component),_createClass(t,[{key:"handleClick",value:function(){this.props.handleVote(this.props.value)}},{key:"render",value:function(){return this.props.isTarget?React.createElement("button",{className:"VoteButton",value:this.props.value,onClick:this.handleClick,disabled:!0},this.props.value):React.createElement("button",{className:"VoteButton",value:this.props.value,onClick:this.handleClick},this.props.value)}}]),t}(),VotingArea=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.toggleConfirmEndGame=a.toggleConfirmEndGame.bind(a),a.state={votingFor:"",confirmingEnd:!1},a}return _inherits(t,React.Component),_createClass(t,[{key:"handleVote",value:function(e){this.setState({votingFor:e}),sendVote(e)}},{key:"renderButton",value:function(e){var t=this;return React.createElement(VoteButton,{key:"votebutton_"+e,isTarget:e===this.state.votingFor,value:e,handleVote:function(e){return t.handleVote(e)}})}},{key:"toggleConfirmEndGame",value:function(){this.setState({confirmingEnd:!this.state.confirmingEnd})}},{key:"render",value:function(){var e=this;if(this.state.confirmingEnd)return React.createElement("div",{className:"votingArea"},React.createElement(ConfirmDialog,{prompt:"Skip to the end of voting and finish the game?",onCancel:this.toggleConfirmEndGame,onConfirm:sendFinishGame}));var t=this.props.playerList.filter((function(t){return t!=e.props.myName})).map((function(t){return e.renderButton(t)})),a=""===this.state.votingFor?"":"You are voting for "+this.state.votingFor;return React.createElement("div",{className:"votingArea"},React.createElement("p",null,"Choose a player to vote for: "),React.createElement("div",{className:"voteButtons"},t),React.createElement("p",null,a),React.createElement("button",{className:"endGameButton",onClick:this.toggleConfirmEndGame},"End voting phase"))}}]),t}();function ConfirmDialog(e){return React.createElement("div",{className:"confirmDialog"},React.createElement("p",null,e.prompt),React.createElement("button",{onClick:e.onCancel},"Cancel"),React.createElement("button",{onClick:e.onConfirm},"Do it!"))}var InfoArea=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var e=this.props.role;return this.props.bedTimePhase?React.createElement("div",{className:"infoArea roleActive"},React.createElement("p",null,"The night is starting soon...")):this.props.nightPhase?this.props.role===this.props.turn?React.createElement("div",{className:"infoArea roleActive"},React.createElement("p",null,"It is the ",this.props.role," turn. That means you!"),React.createElement("p",{className:"turnTimer"},this.props.timer)):React.createElement("div",{className:"infoArea"},React.createElement("p",null,this.make_role_string(e)," "),React.createElement("div",{className:"intelligence"},this.make_intelligence_list()),React.createElement("p",null,"It is currently the ",this.props.turn," turn."),React.createElement("p",{className:"timer"},this.props.timer)):this.props.votingPhase?React.createElement("div",{className:"infoArea votingActive"},React.createElement("p",null,this.make_role_string(e)," "),React.createElement("div",{className:"intelligence"},this.make_intelligence_list()),React.createElement("p",{className:"timer"},this.props.timer)):React.createElement("p",null,"Waiting for a game to start")}},{key:"make_role_string",value:function(e){return"NOTHING"===e?"You do not have a role right now.":this.props.votingPhase?"In the beginning, your role was "+(isVowel(e.charAt(0))?"an":"a")+" "+e+".":"You are "+(isVowel(e.charAt(0))?"an":"a")+" "+e+"."}},{key:"make_role_list",value:function(e){for(var t={},a=0;a<e.length;a++)t[e[a]]?t[e[a]]+=1:t[e[a]]=1;return Object.entries(t).map((function(e){var t=_slicedToArray(e,2),a=t[0],n=t[1];return React.createElement("li",{key:a},a,": x",n)}))}},{key:"make_intelligence_list",value:function(){return React.createElement("ul",null,this.props.intelligence.map((function(e){return React.createElement("li",null,e)})))}}]),t}(),ResultsArea=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var e=this.props.results;return React.createElement("div",{className:"resultsArea"},React.createElement("p",null,"The following players were eliminated:"),React.createElement("ul",null,this.makeList(e.elims)),React.createElement("p",null,"The winners are:"),React.createElement("ul",null," ",this.makeList(e.winners)," "),React.createElement("button",{onClick:this.props.onExit},"Back to lobby"))}},{key:"makeList",value:function(e){var t=this;return 0===e.length?React.createElement("li",{key:"Nobody"},"Nobody!"):e.map((function(e){return React.createElement("li",{key:e},e," (",t.props.results.player_results[e].role_end,")")}))}}]),t}(),Game=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={nightPhase:!1,votingPhase:!1,gameOver:!1,turn:"NOTHING",myRole:e.gameStartInfo.role,timer:0,inPlay:e.gameStartInfo.in_play,results:{},roleIntelligence:[]},a}return _inherits(t,React.Component),_createClass(t,[{key:"componentDidMount",value:function(){var e=this;socket.on("gameStateUpdate",(function(t){console.log("gamestateupdate:"),console.log(t),t.has_game&&e.setState({turn:t.turn,timer:t.time_left,nightPhase:t.isNight,votingPhase:!t.isNight})})),socket.on("resultAnnouncement",(function(t){e.setState({nightPhase:!1,votingPhase:!1,gameOver:!0,results:t})}))}},{key:"componentWillUnmount",value:function(){socket.on("gameStateUpdate",(function(e){console.log("Got gameStateUpdate, but Game component is unmounted")})),socket.on("resultAnnouncement",(function(e){console.log("Got resultAnnouncement, but Game component is unmounted")}))}},{key:"startGame",value:function(){sendStartGame()}},{key:"appendToIntelligence",value:function(e){this.setState({roleIntelligence:[].concat(_toConsumableArray(this.state.roleIntelligence),[e])})}},{key:"render",value:function(){var e=this;if(!this.state.gameOver){var t=React.createElement("div",null);return this.state.votingPhase?t=React.createElement(VotingArea,{playerList:this.props.playerList,myName:this.props.myName}):(this.state.nightPhase||this.props.bedTimePhase)&&(t=React.createElement(PlayArea,{myName:this.props.myName,startGame:function(){return e.startGame()},bedTimePhase:this.props.bedTimePhase,nightPhase:this.state.nightPhase,turn:this.state.turn,role:this.state.myRole,playerList:this.props.playerList,centerCount:this.state.inPlay.length-this.props.playerList.length,addIntel:function(t){return e.appendToIntelligence(t)}})),React.createElement("div",{className:"game"},React.createElement(InfoArea,{myName:this.props.myName,role:this.state.myRole,turn:this.state.turn,timer:this.state.timer.toString(),inPlay:this.state.inPlay,bedTimePhase:this.props.bedTimePhase,nightPhase:this.state.nightPhase,votingPhase:this.state.votingPhase,playerList:this.props.playerList,intelligence:this.state.roleIntelligence}),t)}return React.createElement("div",{className:"game"},React.createElement(ResultsArea,{results:this.state.results,onExit:this.props.onExit}))}}]),t}(),SettingsView=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.handleSetRoles=a.handleSetRoles.bind(a),a.state={rolesWithCounts:Object.assign({},a.props.rolesWithCounts)},a}return _inherits(t,React.Component),_createClass(t,[{key:"addRemoveRole",value:function(e,t){var a=this.state.rolesWithCounts;e in a&&(t?a[e]+=1:a[e]-=1),(!(e in a)||a[e]<0)&&(a[e]=0),this.setState({rolesWithCounts:a})}},{key:"handleSetRoles",value:function(){this.props.onSetRoles(this.state.rolesWithCounts)}},{key:"render",value:function(){var e=this,t=Object.keys(this.state.rolesWithCounts).map((function(t){return React.createElement("div",{className:"roleSelection",key:t+"_selection"},React.createElement("span",{className:"roleSelectText"},React.createElement("span",null,t,":"),React.createElement("span",{className:"roleCount"},e.state.rolesWithCounts[t])),React.createElement("div",{className:"plusMinusButtons"},React.createElement("button",{onClick:function(a,n){return e.addRemoveRole(t,!1)}},"-"),React.createElement("button",{onClick:function(a,n){return e.addRemoveRole(t,!0)}},"+")))}));return React.createElement("div",{className:"settingsView"},React.createElement("div",{className:"roleMenu"},t),React.createElement("div",{className:"bottomButtons"},React.createElement("button",{onClick:this.props.onCancel},"Cancel"),React.createElement("button",{onClick:this.handleSetRoles},"Confirm")))}}]),t}(),Lobby=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.toggleReady=a.toggleReady.bind(a),a.toggleSettings=a.toggleSettings.bind(a),a.state={ready:!1,rolesWithCounts:{},showSettings:!1},a}return _inherits(t,React.Component),_createClass(t,[{key:"componentDidMount",value:function(){var e=this;socket.on("gameSettingsMessage",(function(t){e.setState({rolesWithCounts:t.roles})})),sendGetSettingsMessage()}},{key:"componentWillUnmount",value:function(){socket.on("gameSettingsMessage",(function(e){console.log("Component has been unmounted.")}))}},{key:"toggleReady",value:function(){sendReadyMessage()}},{key:"toggleSettings",value:function(){this.setState({showSettings:!this.state.showSettings})}},{key:"handleSetRoles",value:function(e){sendSetSettingsMessage({roles:e}),sendGetSettingsMessage(),this.setState({showSettings:!1})}},{key:"renderPlayerList",value:function(){var e=this.props.players.map((function(e){var t=_slicedToArray(e,2),a=t[0],n=t[1];return React.createElement("li",{key:"lobby_"+a},a,": ",n?"Ready":"Not ready")}));return React.createElement("div",{className:"playerList"},React.createElement("h2",null,"Connected players:"),React.createElement("ul",null,e))}},{key:"renderSettingsList",value:function(){var e=this,t=Object.keys(this.state.rolesWithCounts).filter((function(t){return e.state.rolesWithCounts[t]>0})),a=0,n=t.map((function(t){var n=e.state.rolesWithCounts[t];return a+=n,React.createElement("li",{key:"lobby_roles_"+t},t,": x",n)}));return React.createElement("div",{className:"lobbySettings"},React.createElement("h2",null,"Selected roles:"),React.createElement("ul",{className:"roleList"},n),React.createElement("p",null,"Total cards: ",a))}},{key:"playerIsReady",value:function(){var e=!0,t=!1,a=void 0;try{for(var n,r=this.props.players[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var s=n.value;if(s[0]===this.props.myName)return s[1]}}catch(e){t=!0,a=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw a}}}},{key:"render",value:function(){var e=this;return this.state.showSettings?React.createElement("div",{className:"gameLobby"},React.createElement(SettingsView,{rolesWithCounts:this.state.rolesWithCounts,onCancel:this.toggleSettings,onSetRoles:function(t){return e.handleSetRoles(t)}})):React.createElement("div",{className:"gameLobby"},React.createElement("h1",null,"Lobby"),React.createElement("p",{className:"serverMessage"},this.props.serverMessage),React.createElement("div",{className:"pregameInfoContainer"},this.renderPlayerList(),this.renderSettingsList()),React.createElement("div",{className:"bottomButtons"},React.createElement("button",{onClick:this.toggleSettings},"Settings"),React.createElement("button",{onClick:this.toggleReady},this.playerIsReady()?"Unready":"Ready")))}}]),t}();function LoginMenu(e){var t=""!==e.nameFeedback?React.createElement("p",null,e.nameFeedback):"";return React.createElement("div",{className:"loginMenu"},React.createElement("div",{className:"nameFeedback"},t),React.createElement("p",null,"Enter your name:"),React.createElement("input",{type:"text",id:"nameInputField"}),React.createElement("button",{onClick:sendLoginMessage},"OK"))}var App=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={pregame:!0,bedTimePhase:!1,playerReadyList:[["Player",!0],["Player2",!0],["Player3",!0]],myUsername:"Player",gameStartData:{role:"NOTHING",in_play:["SEER","VILLAGER","WEREWOLF"]},serverMessage:"",loggedIn:!1,nameFeedback:""},a.handleBackToLobby=a.handleBackToLobby.bind(a),a}return _inherits(t,React.Component),_createClass(t,[{key:"componentDidMount",value:function(){var e=this;socket.on("playerListUpdate",(function(t){e.setState({playerReadyList:t})})),socket.on("gameStartInfo",(function(t){e.setState({pregame:!1,bedTimePhase:!0,gameStartData:t})})),socket.on("name_confirmed",(function(t){e.setState({myUsername:t,loggedIn:!0})})),socket.on("nameFeedback",(function(t){e.setState({nameFeedback:t})})),socket.on("serverMessage",(function(t){e.setState({serverMessage:t})})),socket.on("nightBeginsMessage",(function(){e.setState({bedTimePhase:!1})})),socket.on("serverResetMessage",(function(t){e.setState({pregame:!0,bedTimePhase:!1,loggedIn:!1,nameFeedback:t})}))}},{key:"componentWillUnmount",value:function(){var e=!0,t=!1,a=void 0;try{for(var n,r=["playerListUpdate","gameStartInfo","name_confirmed","nameFeedback","serverMessage","nightBeginsMessage","serverResetMessage"][Symbol.iterator]();!(e=(n=r.next()).done);e=!0)msgName=n.value,socket.on(msgName,(function(e){console.log("Got "+msgName+", but App component is unmounted")}))}catch(e){t=!0,a=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw a}}}},{key:"handleBackToLobby",value:function(){this.setState({pregame:!0,serverMessage:""}),sendGetPlayerListMessage()}},{key:"render",value:function(){return this.state.loggedIn?this.state.pregame?React.createElement(Lobby,{players:this.state.playerReadyList,serverMessage:this.state.serverMessage,myName:this.state.myUsername}):React.createElement(Game,{playerList:this.state.playerReadyList.map((function(e){return e[0]})),myName:this.state.myUsername,bedTimePhase:this.state.bedTimePhase,gameStartInfo:this.state.gameStartData,onExit:this.handleBackToLobby,serverMessage:this.state.serverMessage}):React.createElement(LoginMenu,{nameFeedback:this.state.nameFeedback})}}]),t}(),domContainer=document.querySelector("#app_container");ReactDOM.render(React.createElement(App,null),domContainer);